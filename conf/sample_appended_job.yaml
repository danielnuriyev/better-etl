name: sample_appended_job
schedule: 0-59 * * * *
ops:
  - name: get_secret
    package:  better_etl.ops
    class:    AWSSecretsManager
    method:   get_secret
    config:
      secret_name: ...
  - name: get_batches
    after:
      - get_secret
    package:  better_etl.ops
    class:    MySQL
    method:   get_batches
    config:
      type:     source
      host:     ...
      user:     ...
      password: ...
      database: ...
      table:    ...
      batch:    1000000
      batches:  1
      cache:
        class:  better_etl.caches.S3Cache
        bucket: ...
        path:   dagster/jobs/sample_appended_job/ops/mysql/get_batch/cache
  - name: store
    after:
      - get_batches
    package:  better_etl.ops
    class:    AWSS3
    method:   store
    config:
      bucket: ...
      path:   tables/sample_appended_job/{time.time()}
      # this is an example of a condition
      condition: >
        batch["data"].size > 0 and
        batch["data"].size < 1000001
